<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg-color: #f4f6f8;
            --danger: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
            --text-color: #333;
        }

        /* ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Base Font ‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≠ */
        html { font-size: 16px; }
        @media (max-width: 768px) { html { font-size: 14px; } }
        @media (max-width: 480px) { html { font-size: 12px; } }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 1rem;
            color: var(--text-color);
        }

        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
        .bg-fixed {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: url('https://images.unsplash.com/photo-1519750783826-e2420f4d687f?q=80&w=1974') center/cover;
            opacity: 0.08;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding-bottom: 3rem;
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        /* --- Tabs --- */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .tab-btn {
            padding: 0.6rem 1.5rem;
            font-family: 'Sarabun', sans-serif;
            font-size: 1rem;
            border: none;
            border-radius: 50px;
            background: white;
            color: #7f8c8d;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: 0.3s;
        }

        .tab-btn.active {
            background: var(--accent);
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4);
        }

        /* --- Content & Table --- */
        .content-area {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            display: none;
        }
        .content-area.active { display: block; }

        .table-responsive {
            width: 100%;
            overflow-x: auto; /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏ì‡∏µ‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å‡πÜ ‡∏à‡∏£‡∏¥‡∏á‡πÜ */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed; /* üëà ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà */
        }

        th {
            background: var(--primary);
            color: white;
            padding: 0.8rem;
            text-align: left;
            font-weight: 500;
            font-size: 0.95rem;
            white-space: nowrap; /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡πâ‡∏≤‡∏°‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ */
        }

        td {
            padding: 0.8rem;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
            vertical-align: top; /* ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏™‡∏°‡∏≠ */
            
            /* üîΩ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ */
            word-wrap: break-word;      
            word-break: break-word;     
            white-space: normal;        
        }

        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f0f4f8; }

        /* ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÅ‡∏ï‡πà‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏© */
        .status-alert {
            color: var(--danger);
            font-weight: bold;
            background: rgba(231, 76, 60, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            display: inline-block;
        }

        .text-center { text-align: center; }
        .text-dim { color: #999; font-size: 0.85rem; }

        /* --- Progress Bar --- */
        .progress-track {
            background: #ecf0f1;
            border-radius: 10px;
            height: 1.2rem;
            width: 100%;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            text-align: right;
            padding-right: 5px;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
            line-height: 1.2rem;
            transition: width 0.5s;
        }
        .bg-red { background: var(--danger); }
        .bg-orange { background: var(--warning); }
        .bg-green { background: var(--success); }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Mobile */
        @media (max-width: 600px) {
            th, td { padding: 0.5rem; } /* ‡∏•‡∏î Padding */
            /* ‡∏ã‡πà‡∏≠‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (Optional) 
               ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÅ‡∏ó‡∏ô */
        }

    </style>
</head>
<body>

    <div class="bg-fixed"></div>

    <div class="container">
        <h1>üì¶ Dashboard ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏á‡∏≤‡∏ô</h1>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('tab1', this)">‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</button>
            <button class="tab-btn" onclick="switchTab('tab2', this)">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</button>
        </div>

        <div id="tab1" class="content-area active">
            <div id="loading1" class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            <div class="table-responsive">
                <table id="table1">
                    <colgroup>
                        <col style="width: 40%;"> <col style="width: 15%;"> <col style="width: 15%;"> <col style="width: 15%;"> <col style="width: 15%;"> </colgroup>
                    <thead>
                        <tr>
                            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th class="text-center">‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà</th>
                            <th class="text-center">‡∏Ç‡∏≤‡∏î</th>
                            <th class="text-center">‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div id="tab2" class="content-area">
            <div id="loading2" class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            <div class="table-responsive">
                <table id="table2">
                    <colgroup>
                        <col style="width: 50%;"> <col style="width: 20%;"> <col style="width: 30%;"> </colgroup>
                    <thead>
                        <tr>
                            <th>‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                            <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // üîó ‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå CSV ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏£‡∏±‡∏ö
        // ============================================
        
        const URL_MATERIAL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ75RDJdohY6N12_oX9IVC48zBLT3nU4Ym_VJXaaalYcGY9wlSyyXvBOJCfRkzxvVh8BCgCwbnFZc7G/pub?gid=416405025&single=true&output=csv';
        const URL_ACTIVITY = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQ75RDJdohY6N12_oX9IVC48zBLT3nU4Ym_VJXaaalYcGY9wlSyyXvBOJCfRkzxvVh8BCgCwbnFZc7G/pub?gid=1666533702&single=true&output=csv'; 

        // ============================================

        document.addEventListener('DOMContentLoaded', () => {
            loadMaterial();
            loadActivity();
        });

        function switchTab(id, btn) {
            document.querySelectorAll('.content-area').forEach(e => e.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(e => e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        // --- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏™‡∏î‡∏∏ ---
        function loadMaterial() {
            Papa.parse(URL_MATERIAL, {
                download: true, header: true, skipEmptyLines: true,
                complete: function(results) {
                    const tbody = document.querySelector('#table1 tbody');
                    document.getElementById('loading1').style.display = 'none';
                    tbody.innerHTML = '';

                    results.data.forEach(row => {
                        const item = row['‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'] || '-';
                        const have = row['‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà'] || '-';
                        const want = row['‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å'] || '0';
                        const unit = row['‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö'] || '';
                        const note = row['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'] || '';

                        let wantDisplay = want;
                        if(parseInt(want) > 0) wantDisplay = `<span class="status-alert">${want}</span>`;

                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${item}</td>
                            <td class="text-center">${have}</td>
                            <td class="text-center">${wantDisplay}</td>
                            <td class="text-center text-dim">${unit}</td>
                            <td class="text-dim">${note}</td>
                        `;
                        tbody.appendChild(tr);
                    });
                }
            });
        }

        // --- ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ---
        function loadActivity() {
            if(URL_ACTIVITY.includes('‡πÉ‡∏™‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå')) return;

            Papa.parse(URL_ACTIVITY, {
                download: true, header: true, skipEmptyLines: true,
                complete: function(results) {
                    const tbody = document.querySelector('#table2 tbody');
                    document.getElementById('loading2').style.display = 'none';
                    tbody.innerHTML = '';

                    results.data.forEach(row => {
                        const item = row['‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'] || '-';
                        const note = row['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'] || '-';
                        let percent = parseInt(row['‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (0-100%)']) || 0;

                        let colorClass = 'bg-red';
                        if(percent > 30) colorClass = 'bg-orange';
                        if(percent > 70) colorClass = 'bg-green';

                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${item}</td>
                            <td class="text-dim">${note}</td>
                            <td>
                                <div class="progress-track">
                                    <div class="progress-fill ${colorClass}" style="width: ${percent}%">
                                        ${percent}%
                                    </div>
                                </div>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                }
            });
        }
    </script>
</body>
</html>
